extends layout

block content

  input#str_id(type="hidden",value=str_id)
  .container
    .row  
      .col.h5 String #{str_lbl} : 
        span#vSum.ms-2.fw-bolder
        span.ms-1 volts 
        span.ms-4.fw-bolder(id="i_str" + str_id)
        span.ms-1 amps
  .container

    .row.border.border-primary.strrow.ms-1.shadow()
      .col-2
        table.maxmin.table-bordered.caption-top
          caption Max Voltages
          th Tray 
          th Volts

          - var row = 0
          while (row < 10)
            tr(id="vMaxRow" + row)
              td(id="vMaxTray" + row)
              td(id="vMaxVal" + row) 
              - row++
        table.maxminnum
          tr
            td High Volt Trays
            td#vNumHigh 
            td 

      .col-3
        table.maxmin.table-bordered.caption-top.ms-2()
          caption Min Voltages
          th Tray 
          th Volts

          - var row = 0
          while (row < 10)
            tr(id="vMinRow" + row)
              td(id="vMinTray" + row )
              td(id="vMinVal" + row)
              - row++
        table.maxminnum
          tr
            td Low Volt Trays
            td#vNumLow 
            td

      .col-7
        table.table-bordered.caption-top.traytbl
          caption Tray Voltages
          - var offset_cell = str_id * 70 + 1 
          - var rows = 7
          - var cols = 10
          - var row_cnt = 0
          - var inx_cnt = 1
          - var str_num = str_id + 1
          - var ttl_str = "tray"+str_num+"-"
          while (row_cnt < rows)
            tr
              - var col_cnt = 0
              while (col_cnt < cols)
                - cell_cnt = offset_cell + col_cnt
                td.cfs(id="v" +cell_cnt, title=ttl_str+inx_cnt) &nbsp;
                - col_cnt++
                - inx_cnt++
              - offset_cell = offset_cell + cols
              - row_cnt++
        include includes/spVolts.pug
    .row.border.border-primary.strrow.mt-3.ms-1.shadow()
      .col-3
        table.maxmin.table-bordered.caption-top()
          caption Max Temperature
          th Tray 
          th °F

          - var row = 0
          while (row < 10)
            tr(id="tMaxRow" + row)
              td(id="tMaxTray" + row)
              td(id="tMaxVal" + row) 
              - row++
        table.maxminnum
          tr
            td High Temp Trays
            td#tNumHigh 
            td
      .col-2
      .col-4
        table.table-bordered.caption-top.traytbl(style="width:400px")
          caption Tray Temperatures °F
          - var offset_cell = str_id * 70 + 1 
          - var rows = 7
          - var cols = 10
          - var row_cnt = 0
          - var inx_cnt = 1
          - var str_num = str_id + 1
          - var ttl_str = "tray"+str_num+"-"
          while (row_cnt < rows)
            tr
              - var col_cnt = 0
              while (col_cnt < cols)
                - cell_cnt = offset_cell + col_cnt
                td.cfs(id="t" +cell_cnt, title=ttl_str+inx_cnt) &nbsp;
                - col_cnt++
                - inx_cnt++
              - offset_cell = offset_cell + cols
              - row_cnt++
        include includes/spTemp.pug
    .row.border.border-primary.strrow.mt-3.ms-1.shadow()
      .col-3
        table.maxmin.table-bordered.caption-top()
          caption Max Balance 
          th Tray
          th %
          - var row = 0
          while (row < 10)
            tr(id="bMaxRow" + row)
              td(id="bMaxTray" + row)
              td(id="bMaxVal" + row) 
              - row++
        table.maxminnum
          tr
            td High Balance Trays
            td#bNumHigh 
            td
      .col-2
      .col-4
        table.table-bordered.caption-top.traytbl(style="width:400px")
          caption Tray Balance Percent
          - var offset_cell = str_id * 70 + 1 
          - var rows = 7
          - var cols = 10
          - var row_cnt = 0
          - var inx_cnt = 1
          - var str_num = str_id + 1
          - var ttl_str = "tray"+str_num+"-"
          while (row_cnt < rows)
            tr
              - var col_cnt = 0
              while (col_cnt < cols)
                - cell_cnt = offset_cell + col_cnt
                td.cfs(id="b" +cell_cnt, title=ttl_str+inx_cnt) &nbsp;
                - col_cnt++
                - inx_cnt++
              - offset_cell = offset_cell + cols
              - row_cnt++
        include includes/spBalance.pug
    .row.border.border-primary.strrow.my-3.ms-1.shadow()
      .col-3
        table.maxmin.table-bordered.caption-top()
          caption Max Impedance
          th Tray
          th mOhm
          - var row = 0
          while (row < 10)
            tr(id="rMaxRow" + row)
              td(id="rMaxTray" + row)
              td(id="rMaxVal" + row) 
              - row++
        table.maxminnum
          tr
            td High Impedance Trays
            td#rNumHigh 
          
      .col-2
      .col-4
        table.table-bordered.caption-top.traytbl(style="width:400px")
          caption Tray Impedance mOhm
          - var offset_cell = str_id * 70 + 1 
          - var rows = 7
          - var cols = 10
          - var row_cnt = 0
          - var inx_cnt = 1
          - var str_num = str_id + 1
          - var ttl_str = "tray"+str_num+"-"
          while (row_cnt < rows)
            tr
              - var col_cnt = 0
              while (col_cnt < cols)
                - cell_cnt = offset_cell + col_cnt
                td.cfs(id="r" +cell_cnt, title=ttl_str+inx_cnt) &nbsp;
                - col_cnt++
                - inx_cnt++
              - offset_cell = offset_cell + cols
              - row_cnt++
        include includes/spImpedance.pug

  script.

    $( document ).ready( () => {

      getSetPoints()   
      
      data_xhr = get_str_data
      data_xhr()

      //document.getElementById("str").classList.add("active");
    })